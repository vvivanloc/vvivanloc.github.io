"use strict";function setupHandlers(e){setAttributes(e,{onmouseup:"handleMouseUp(evt)",onmousedown:"handleMouseDown(evt)",onmousemove:"handleMouseMove(evt)"});var t=navigator.userAgent.toLowerCase(),n=!!t.match(/trident\/7\./);t.indexOf("webkit")>=0||n?window.addEventListener("mousewheel",handleMouseWheel,!1):window.addEventListener("DOMMouseScroll",handleMouseWheel,!1)}function getRoot(e){if(null==svgRoot){for(var t=e.getElementById("viewport")?e.getElementById("viewport"):e.documentElement,n=t;n!=e;)n.getAttribute("viewBox")&&(setCTM(t,n.getCTM()),n.removeAttribute("viewBox")),n=n.parentNode;svgRoot=t}return svgRoot}function getEventPoint(e){var t=root.createSVGPoint();return t.x=e.clientX,t.y=e.clientY,t}function setCTM(e,t){var n="matrix("+t.a+","+t.b+","+t.c+","+t.d+","+t.e+","+t.f+")";e.setAttribute("transform",n)}function dumpMatrix(e){var t="[ "+e.a+", "+e.c+", "+e.e+"\n  "+e.b+", "+e.d+", "+e.f+"\n  0, 0, 1 ]";return t}function setAttributes(e,t){for(var n in t)e.setAttributeNS(null,n,t[n])}function handleMouseWheel(e){if(enableZoom){e.preventDefault&&e.preventDefault(),e.returnValue=!1;var t,n=e.target.ownerDocument;t=e.wheelDelta?e.wheelDelta/360:e.detail/-9;var a=Math.pow(1+zoomScale,t),r=getRoot(n),o=getEventPoint(e);o=o.matrixTransform(r.getCTM().inverse());var s=root.createSVGMatrix().translate(o.x,o.y).scale(a).translate(-o.x,-o.y);setCTM(r,r.getCTM().multiply(s)),"undefined"==typeof stateTf&&(stateTf=r.getCTM().inverse()),stateTf=stateTf.multiply(s.inverse())}}function handleMouseMove(e){e.preventDefault&&e.preventDefault(),e.returnValue=!1;var t=e.target.ownerDocument,n=getRoot(t);if("pan"==state&&enablePan){var a=getEventPoint(e).matrixTransform(stateTf);setCTM(n,stateTf.inverse().translate(a.x-stateOrigin.x,a.y-stateOrigin.y))}else if("drag"==state&&enableDrag){var a=getEventPoint(e).matrixTransform(n.getCTM().inverse());setCTM(stateTarget,root.createSVGMatrix().translate(a.x-stateOrigin.x,a.y-stateOrigin.y).multiply(n.getCTM().inverse()).multiply(stateTarget.getCTM())),stateOrigin=a}}function handleMouseDown(e){e.preventDefault&&e.preventDefault(),e.returnValue=!1;var t=e.target.ownerDocument,n=getRoot(t);"svg"!=e.target.tagName&&enableDrag?(state="drag",stateTarget=e.target,stateTf=n.getCTM().inverse(),stateOrigin=getEventPoint(e).matrixTransform(stateTf)):(state="pan",stateTf=n.getCTM().inverse(),stateOrigin=getEventPoint(e).matrixTransform(stateTf))}function handleMouseUp(e){e.preventDefault&&e.preventDefault(),e.returnValue=!1;e.target.ownerDocument;("pan"==state||"drag"==state)&&(state="")}var enablePan=1,enableZoom=1,enableDrag=0,zoomScale=.2,root=document.documentElement,state="none",svgRoot=null,stateTarget,stateOrigin,stateTf;setupHandlers(root);